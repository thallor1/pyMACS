
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sample &#8212; pyMACS 0.1 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/blank.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Kidney" href="kidney.html" />
    <link rel="prev" title="virtualMACS" href="virtualMACS.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="index.html">
<p class="title">pyMACS</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="usage.html">
  Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="virtualMACS.html">
  virtualMACS
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Sample
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="kidney.html">
  Kidney
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="macsdata.html">
  Data
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="monochromator.html">
  Monochromator
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="http://mcstas.org">mcstas-homepage<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/thallor1/pyMACS">pyMACS-github<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="virtualMACS.html">virtualMACS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="kidney.html">Kidney</a></li>
<li class="toctree-l1"><a class="reference internal" href="macsdata.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="monochromator.html">Monochromator</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/sample.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="sample">
<h1>Sample<a class="headerlink" href="#sample" title="Permalink to this headline">¶</a></h1>
<p>Object containing information regarding the sample properties,
its orientation, and methods to calculate certain quantities regarding the sample.</p>
<dl class="py class">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">virtualMACS.sample.</span></span><span class="sig-name descname"><span class="pre">Sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_recip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default_sample'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cylinder'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_diameter_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_tilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.04</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_widx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_widy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_widz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.003</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_ops</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">space_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ciffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laufile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customlaufile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient_u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_abs_fu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_abs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_inc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_mosaic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_axis_xrot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_axis_yrot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_axis_zrot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">15.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample" title="Permalink to this definition">¶</a></dt>
<dd><p>The purpose of this class is to perform operations related to intrinsic sample properties that will ultimately be simulated.
It contains information regarding the sample itself as well as its orientaion, and methods to calculate crystallographic quantities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – Length of lattice vector in a-direction (Ang)</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Length of lattice vector in b-direction (Ang)</p></li>
<li><p><strong>c</strong> (<em>float</em>) – length of lattice vector in c-direction (Ang)</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Lattice alpha angle (deg)</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Lattice beta angle (deg)</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – Lattice gamma angle (deg)</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name assosciated with the sample.</p></li>
<li><p><strong>astar</strong> (<em>np.ndarray of len 3</em>) – Reciprocal lattice vector astarin Ang^-1. Calculated from direct lattice and should not be input.</p></li>
<li><p><strong>bstar</strong> (<em>np.ndarray of len 3</em>) – Reciprocal lattice vector bstar in Ang^-1. Calculated from direct lattice and should not be input.</p></li>
<li><p><strong>cstar</strong> (<em>np.ndarray of len 3</em>) – Reciprocal lattice vector cstar in Ang^-1. Calculated from direct lattice and should not be input</p></li>
<li><p><strong>avec</strong> (<em>np.ndarray of len 3</em>) – Direct lattice vector a in Ang. Calculated from lattice specification and should not be input.</p></li>
<li><p><strong>bvec</strong> (<em>np.ndarray of len 3</em>) – Direct lattice vector b in Ang. Calculated from lattice specification and should not be input.</p></li>
<li><p><strong>cvec</strong> (<em>np.ndarray of len 3</em>) – Direct lattice vector c in Ang. Calculated from lattice specification and should not be input.</p></li>
<li><p><strong>cell_vol</strong> (<em>float</em>) – Direct unit cell volume in Ang^3, again calculated.</p></li>
<li><p><strong>cell_vol_recip</strong> (<em>float</em>) – Recriprocal unit cell volume in Ang^-1, calculated.</p></li>
<li><p><strong>sample_shape</strong> (<em>str</em>) – Sample shape which also affects many parts of the simulation. The allowed values for this are the following (‘box’,’cylinder’,’powder’,’spot_box’,’spot_cylinder’,’box_inel_crystal’). 
The first three simulate only elastic scattering with their respective geometries. The spot_box and spot_cylinder components are effectively powders with a delta function in Q and energy. 
Finally, the box_inel_crystal shape allows for the insertion of a delta function at arbitrary points in Q-E space.</p></li>
<li><p><strong>sample_diameter_d</strong> (<em>float</em>) – For cylinder shape, the diameter</p></li>
<li><p><strong>sample_tilt</strong> (<em>float</em>) – Tilt of cylinder from the vertical axis, with 0 being vertical and the rotation axis being the x-axis
or perpendicular to the beam. In degrees.</p></li>
<li><p><strong>sample_length</strong> (<em>float</em>) – Length of cylinder geometry in m.</p></li>
<li><p><strong>sample_widx</strong> (<em>float</em>) – Box geometry width in the x-direction in m.</p></li>
<li><p><strong>sample_widy</strong> (<em>float</em>) – Box geometry width in the y-direction in m.</p></li>
<li><p><strong>sample_widz</strong> (<em>float</em>) – Box geometry width in the z-direction in m.</p></li>
<li><p><strong>ciffile</strong> (<em>str</em>) – Cif file assosciated with sample initialization.</p></li>
<li><p><strong>b_arr</strong> (<em>dict</em>) – Scattering lengths of ions in sample. Usually extracted from built in NIST tables.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.QE_to_twotheta">
<span class="sig-name descname"><span class="pre">QE_to_twotheta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qmag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.QE_to_twotheta" title="Permalink to this definition">¶</a></dt>
<dd><p>Given HKL indices, incident energy, and energy transfer, returns the scattering angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Qmag</strong> (<em>float</em>) – Input Q-magnitude in Ang^-1</p></li>
<li><p><strong>Ei</strong> (<em>float</em>) – Incident neutron energy in meV</p></li>
<li><p><strong>omega</strong> (<em>float</em>) – Neutron energy transfer at sample in meV</p></li>
<li><p><strong>mode</strong> – Determines if angle is returned in degrees or radians. Allowed values ‘deg’ or ‘rad’.</p></li>
</ul>
</dd>
<dt class="field-even">Return twoTheta</dt>
<dd class="field-even"><p>Neutron scattering angle in (deg/rad)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.Qmag_HKL">
<span class="sig-name descname"><span class="pre">Qmag_HKL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.Qmag_HKL" title="Permalink to this definition">¶</a></dt>
<dd><p>For a specfied reflection in H, K, L, returns the magnitude of its momentum transfer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>int / float</em>) – H-index of reflection. (rlu)</p></li>
<li><p><strong>K</strong> (<em>int / float</em>) – K-index of reflection. (rlu)</p></li>
<li><p><strong>L</strong> (<em>int / float</em>) – L-index of reflection. (rlu)</p></li>
</ul>
</dd>
<dt class="field-even">Return qmag</dt>
<dd class="field-even"><p>Structure factor squared (barn)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.adjust_hkl_inelastic">
<span class="sig-name descname"><span class="pre">adjust_hkl_inelastic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.adjust_hkl_inelastic" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Very particular function to determine what elastic reflection would yield a particular inelastic reflection by simply </dt><dd><p>scaling down kf and keeping the same scattering angle. Used for the direct calculation of the resolution function at
particular points in Q-E space. Generally not useful to users. In essence, in order to calculate inelastic scattering
at the desired H,K,L values input to this function, one must use the output of this function in the .lau file
used to determine crystal reflections.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>int / float</em>) – H-index of reflection. (rlu)</p></li>
<li><p><strong>K</strong> (<em>int / float</em>) – K-index of reflection. (rlu)</p></li>
<li><p><strong>L</strong> (<em>int / float</em>) – L-index of reflection. (rlu)</p></li>
<li><p><strong>Ei</strong> (<em>float</em>) – Incident neutron energy. (meV)</p></li>
<li><p><strong>Ef</strong> (<em>float</em>) – Final neutron energy after scattering. (meV)</p></li>
</ul>
</dd>
<dt class="field-even">Return reflection</dt>
<dd class="field-even"><p>Equivalent H,K,L points of elastic reflection to match input inelastic reflection.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.fetch_F_HKL">
<span class="sig-name descname"><span class="pre">fetch_F_HKL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.fetch_F_HKL" title="Permalink to this definition">¶</a></dt>
<dd><p>For a specified reflection in H, K, L, returns a squared structure factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>int / float</em>) – H-index of reflection. (rlu)</p></li>
<li><p><strong>K</strong> (<em>int / float</em>) – K-index of reflection. (rlu)</p></li>
<li><p><strong>L</strong> (<em>int / float</em>) – L-index of reflection. (rlu)</p></li>
</ul>
</dd>
<dt class="field-even">Return F</dt>
<dd class="field-even"><p>Structure factor squared (barn)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.gen_custom_lau">
<span class="sig-name descname"><span class="pre">gen_custom_lau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HKL_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sqwlist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/media/sf_OneDrive_-_Johns_Hopkins/pyMACS/pyMACS-docs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">launame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.gen_custom_lau" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Given a set of reflections and structre factors, generates a custom LAU file with columnns of</dt><dd><p>[ H K L S(q,w)] as required by the single_crystal_inelastic component</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>HKL_list</strong> (<em>np.ndarray</em>) – np array of reflections of format np.array([[H1,K1,L1],[H2,K2,L2],….[Hn,Kn,Ln]])</p></li>
<li><p><strong>Sqwlist</strong> (<em>np.ndarray</em>) – np array of structure factors, matching each reflection.</p></li>
<li><p><strong>Ei</strong> (<em>float</em>) – Incident neutron energy (meV)</p></li>
<li><p><strong>omega</strong> (<em>float</em>) – Energy transfer at sample (meV)</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Filename of output lau file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.gen_reflection_list">
<span class="sig-name descname"><span class="pre">gen_reflection_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxQmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.gen_reflection_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the structure factor for all reflections in the unit cell up to some maximum momentum transfer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_tau</strong> (<em>int</em>) – Maximum index (doesn’t matter which) allowed for reflection generation. Default is 20.</p></li>
<li><p><strong>maxQmag</strong> (<em>float</em>) – Alternate way to specify maximum allowed reflection, maximum momentum transfer in Ang^-1.</p></li>
</ul>
</dd>
<dt class="field-even">Return tau</dt>
<dd class="field-even"><p>List of reflections in a matrix with columns [H K L S(Q)^2] where S(Q)^2 is the structure factor. 
Structure factors account for multiplicity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.gen_unique_coords">
<span class="sig-name descname"><span class="pre">gen_unique_coords</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.gen_unique_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the unique coordinates in the unit cell in fractional coordinates. Uses symmetry 
operations as specified in cif file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return coords</dt>
<dd class="field-odd"><p>Returns a dictionary of coordinates with columns [ion,label,x,y,z,occupancy,thermal_dispacement,Uiso,site_multiplicity]
Here, x,y,z are the coordinates in fractional coordinates and ‘ion’ refers to the element.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.gen_unit_cell_positions">
<span class="sig-name descname"><span class="pre">gen_unit_cell_positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.gen_unit_cell_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the coordinates of ions in the unit cell in fractional coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Return structure array</dt>
<dd class="field-odd"><p>Returns a numpy array with coulmns of [ion, b_elastic, x, y, z, occupancy].
Here ion refers to the ion name and b_elastic is the elastic scattering cross section.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.generate_symmetry_operations">
<span class="sig-name descname"><span class="pre">generate_symmetry_operations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.generate_symmetry_operations" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the symmetry operations from the stored cif file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return symm_arr</dt>
<dd class="field-odd"><p>List of symmetry operations in format of [x,y,z]</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.project_sample_realspace">
<span class="sig-name descname"><span class="pre">project_sample_realspace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.project_sample_realspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an alignment in the objects orient_u and orient_v, with u being perpendicular to beam and v parallel to beam
Used to write instr file, where convention is that x is perpendicular to beam, z is beam direction, y is vertical.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.twotheta_hkl">
<span class="sig-name descname"><span class="pre">twotheta_hkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.twotheta_hkl" title="Permalink to this definition">¶</a></dt>
<dd><p>For a specfied reflection in H, K, L, and incident energy, returns the scattering angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>int / float</em>) – H-index of reflection. (rlu)</p></li>
<li><p><strong>K</strong> (<em>int / float</em>) – K-index of reflection. (rlu)</p></li>
<li><p><strong>L</strong> (<em>int / float</em>) – L-index of reflection. (rlu)</p></li>
<li><p><strong>E</strong> (<em>float</em>) – Incident neutron energy. (meV)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Specifies if angle should be returned in radians or degrees. Allowed values are ‘deg’ and ‘rad’.</p></li>
</ul>
</dd>
<dt class="field-even">Return twoTheta</dt>
<dd class="field-even"><p>Scattering angle (degrees / rad)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="virtualMACS.sample.Sample.twotheta_hkl_omega">
<span class="sig-name descname"><span class="pre">twotheta_hkl_omega</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ei</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'deg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#virtualMACS.sample.Sample.twotheta_hkl_omega" title="Permalink to this definition">¶</a></dt>
<dd><p>For a specfied reflection in H, K, L, and incident energy, and energy transfer returns the scattering angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>int / float</em>) – H-index of reflection. (rlu)</p></li>
<li><p><strong>K</strong> (<em>int / float</em>) – K-index of reflection. (rlu)</p></li>
<li><p><strong>L</strong> (<em>int / float</em>) – L-index of reflection. (rlu)</p></li>
<li><p><strong>Ei</strong> (<em>float</em>) – Incident neutron energy. (meV)</p></li>
<li><p><strong>omega</strong> (<em>float</em>) – Neutron energy transfer at sample. (meV)</p></li>
</ul>
</dd>
<dt class="field-even">Return twoTheta</dt>
<dd class="field-even"><p>Scattering angle (degrees / rad)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="virtualMACS.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">virtualMACS</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="kidney.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Kidney</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Thomas Halloran.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.1.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>